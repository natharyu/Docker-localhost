version: '3'

services:
    nginx:
      image: nginx:stable-alpine
      container_name: nginx
      depends_on:
        - php-fpm
      volumes:
        - "./nginx/www:/srv/www:ro" # Your webserver root folder
        - "./nginx/log:/var/log/nginx" # Access to nginx container logs
        - "./nginx/nginx.conf:/etc/nginx/nginx.conf:ro"
      networks: # Comment if not use my traefik docker-compose file
        - traefik # Comment if not use my traefik docker-compose file
        - webserver
      labels: # Comment if not use my traefik docker-compose file
        - "traefik.enable=true" # Comment if not use my traefik docker-compose file
        - "traefik.http.routers.nginx.rule=Host(`webserver.localhost`)" # Comment if not use my traefik docker-compose file
        - "traefik.http.routers.nginx.entrypoints=websecure" # Comment if not use my traefik docker-compose file
        - "traefik.http.routers.nginx.tls=true" # Comment if not use my traefik docker-compose file
      #ports: # Uncomment if not use my traefik docker-compose file
      #  - 80:80 # Uncomment if not use my traefik docker-compose file
    php-fpm:
      image: php:fpm-alpine
      container_name: php-fpm
      volumes:
        - "./nginx/www:/srv/www:ro"
      networks:
        - webserver
networks:
  traefik:
    name: traefik
    external: true
  webserver:
    name: webserver